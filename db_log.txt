Found 64 SQL statements to execute.
Executing: -- OpCore Database Schema (Supabase/PostgreSQL Compatible)
-- Includes "God Mode" Infrastructure & ...
Executing: -- 0. CLEANUP (For God Mode Init)
DROP TABLE IF EXISTS audit_logs CASCADE...
Executing: DROP TABLE IF EXISTS invoices CASCADE...
Executing: DROP TABLE IF EXISTS transactions CASCADE...
Executing: DROP TABLE IF EXISTS tenants CASCADE...
Executing: DROP TABLE IF EXISTS system_settings CASCADE...
Executing: DROP TABLE IF EXISTS compliance_requests CASCADE...
Executing: DROP TABLE IF EXISTS brand_change_history CASCADE...
Executing: DROP TABLE IF EXISTS subscriptions CASCADE...
Executing: DROP TABLE IF EXISTS subscription_history CASCADE...
Executing: DROP TABLE IF EXISTS starting_balances CASCADE...
Executing: DROP TABLE IF EXISTS balance_history CASCADE...
Executing: DROP TABLE IF EXISTS sectors CASCADE...
Executing: -- =============================================
-- 1. SECTORS (Tax Classification)
-- ===========...
Executing: INSERT INTO sectors (name, is_exempt_from_small_co_benefit, description) VALUES
('Agriculture', TRU...
Executing: -- =============================================
-- 2. PROFILES (Tenants)
-- =====================...
Executing: -- =============================================
-- 2. INVOICES (Sales Monitoring) - Moved up for d...
Executing: -- =============================================
-- 3. TRANSACTIONS (Ledger)
-- ==================...
Executing: -- =============================================
-- 4. TAX CONFIG (Global Brain)
-- ==============...
Executing: -- =============================================
-- 5. AUDIT LOGS
-- =============================...
Executing: -- =============================================
-- 6. BRAND HISTORY
-- ==========================...
Executing: -- =============================================
-- 7. SUBSCRIPTIONS
-- ==========================...
Executing: -- =============================================
-- 8. SUBSCRIPTIONS HISTORY
-- ==================...
Executing: -- Trigger to log subscription changes
CREATE OR REPLACE FUNCTION log_subscription_change()
RETURN...
FAILED SQL: -- Trigger to log subscription changes
CREATE OR REPLACE FUNCTION log_subscription_change()
RETURNS TRIGGER AS $$
BEGIN
    IF (TG_OP = 'INSERT') THEN
        INSERT INTO subscription_history (tenant_id, new_status, new_plan, change_reason)
        VALUES (NEW.tenant_id, NEW.status, NEW.plan_type, 'Initial Subscription')
ERROR: unterminated dollar-quoted string at or near "$$
BEGIN
    IF (TG_OP = 'INSERT') THEN
        INSERT INTO subscription_history (tenant_id, new_status, new_plan, change_reason)
        VALUES (NEW.tenant_id, NEW.status, NEW.plan_type, 'Initial Subscription')"
CODE: 42601
